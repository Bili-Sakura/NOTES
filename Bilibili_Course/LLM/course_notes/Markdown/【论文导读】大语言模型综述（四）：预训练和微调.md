# 【论文导读】大语言模型综述（四）：预训练和数据集

## Info

```markdown
**视频简介** 
本系列为《A Survey of Large Language Model》的论文导读系列视频，本视频导读内容为论文的第三章、第四章和第五章，即Resources of LLMs、Pretraining以及Adaptation of LLMs部分。
讲演大纲：
参考材料：
Andrej Karpathy (Director). (2023, January 18). Let’s build GPT: From scratch, in code, spelled out. https://www.youtube.com/watch?v=kCc8FmEb1nY
```

## Outline

- Common Dataset
- Pre-training
  - Data Collection and Preparation
  - Architecture
  - Model Training
- Adaptation of LLMs
  - Instruction Tuning
  - Alignment Tuning
  - Parameter-Efficient Model Adaptation
  - Memory-Efficient Model Adaptation

## Common Dataset

<div align="center">Statistics of commonly-used data sources <a href="https://doi.org/10.48550/arXiv.2303.18223">(Zhao et al., 2023)</a>.</div>


| **Corpora**  | **Size** | **Source**   | **Latest Update Time** |
| ------------ | -------- | ------------ | ---------------------- |
| BookCorpus   | 5GB      | Books        | Dec-2015               |
| Gutenberg    | -        | Books        | Dec-2021               |
| C4           | 800GB    | CommonCrawl  | Apr-2019               |
| CC-Stories-R | 31GB     | CommonCrawl  | Sep-2019               |
| CC-NEWS      | 78GB     | CommonCrawl  | Feb-2019               |
| REALNews     | 120GB    | CommonCrawl  | Apr-2019               |
| OpenWebText  | 38GB     | Reddit links | Mar-2022               |
| Pushift.io   | 2TB      | Reddit links | Mar-2023               |
| Wikipedia    | 21GB     | Wikipedia    | Mar-2023               |
| BigQuery     | 16GB     | Codes        | Mar-2023               |
| the Pile     | 800GB    | Other        | Dec-2020               |
| ROOTS        | 1.6TB    | Other        | Jun-2022               |



> Zhao, W. X., Zhou, K., Li, J., Tang, T., Wang, X., Hou, Y., Min, Y., Zhang, B., Zhang, J., Dong, Z., Du, Y., Yang, C., Chen, Y., Chen, Z., Jiang, J., Ren, R., Li, Y., Tang, X., Liu, Z., … Wen, J.-R. (2023). A Survey of Large Language Models (arXiv:2303.18223). arXiv. [https://](https://doi.org/10.48550/arXiv.2303.18223)[doi.org/10.48550/arXiv.2303.18223](https://doi.org/10.48550/arXiv.2303.18223)

```markdown
content-length: 2188

content-type: text/plain

text: I thought I was going to finish the 3rd season of the Wire tonight. But there was a commentary on episode 11, so I had to re-watch Middle Ground with the commentary. Hopefully I can finish the season next weekend.

timestamp: 2019-04-18T14:16:05Z

url: https://karaokegal.livejournal.com/1773485.html
```

![](../assets/Lesson_4/T5.png)

<div align="center">Left: C4 Dataset Sample - c4/en (default config).* Right: T5 (Text-to-Text Transfer Transformer) (Raffel et al., 2020). (The context length in C4 refers to the number of tokens in each example after tokenization.) </div>

> Raffel, C., Shazeer, N., Roberts, A., Lee, K., Narang, S., Matena, M., Zhou, Y., Li, W., & Liu, P. J. (2020). Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer. Journal of Machine Learning Research, 21(140), 1–67.
>
> https://www.tensorflow.org/datasets/catalog/c4
> 

<div align="center">A detailed list of available collections for instruction tuning (<a href="https://doi.org/10.48550/arXiv.2303.18223">Zhao et al., 2023</a>).</div>

| **Categories** | **Collections**  | **Time** | **#Examples** |
| -------------- | ---------------- | -------- | ------------- |
| Task           | Nat. Inst.       | Apr-2021 | 193K          |
|                | FLAN             | Sep-2021 | 4.4M          |
|                | P3               | Oct-2021 | 12.1M         |
|                | Super Nat. Inst. | Apr-2022 | 5M            |
|                | MVPCorpus        | Jun-2022 | 41M           |
|                | xP3              | Nov-2022 | 81M           |
|                | OIG              | Mar-2023 | 43M           |
| Chat           | HH-RLHF          | Apr-2022 | 160K          |
|                | HC3              | Jan-2023 | 87K           |
|                | ShareGPT         | Mar-2023 | 90K           |
|                | Dolly            | Apr-2023 | 15K           |
|                | OpenAssistant    | Apr-2023 | 161K          |
| Synthetic      | Self-Instruct    | Dec-2022 | 82K           |
|                | Alpaca           | Mar-2023 | 52K           |
|                | Guanaco          | Mar-2023 | 535K          |
|                | Baize            | Apr-2023 | 158K          |
|                | BELLE            | Apr-2023 | 1.5M          |

![image-20240701161247812](../assets/Lesson_4/alpaca.png)

```json
{
"instruction": "Give three tips for staying healthy.",
"input": "",
"output": "1.Eat a balanced diet and make sure to include plenty of fruits and vegetables. \n2. Exercise regularly to keep your body active and strong. \n3. Get enough sleep and maintain a consistent sleep schedule.“
}

```

<div align="center">alpaca_data.json contains 52K instruction-following data we used for fine-tuning the Alpaca model.</div>

> https://github.com/tatsu-lab/stanford_alpaca

<div align="center">A list of available collections for alignment (<a href="https://doi.org/10.48550/arXiv.2303.18223">Zhao et al., 2023</a>).</div>

| **Dataset**                | **Release Time** | **#Examples** |
| -------------------------- | ---------------- | ------------- |
| Summarize from Feedback    | Sep-2020         | 193K          |
| SHP                        | Oct-2021         | 385K          |
| WebGPT Comparisons         | Dec-2021         | 19K           |
| Stack Exchange Preferences | Dec-2021         | 10M           |
| HH-RLHF                    | Apr-2022         | 169K          |
| Sandbox Alignment Data     | May-2023         | 169K          |
| CValues                    | Jul-2023         | 145K          |
| PKU-SafeRLHF               | Oct-2023         | 330K          |

```
Human: What are some cuss words in english? 

Assistant: Here’s an incomplete list. Ass, dick, bugger, crap, fuck, shit, bitch, turd, shithead, shitbag, scrotum, cunt, whore, fucker, shit-eating, cum, cumbucket, fucknugget, butthole, poop, jackass, cocksucker, asshole, goddamn, piss, sperm, blow, wank, jism, cum-sucking, masturbate, faggot, queer, jizz, jizz-licking, prostitute, slut, cheater, fornicator, floozy, wetback, Mexican, Hispanic, sodomite, midget, mama’s boy, faggot, pervert, queer, scumbag, bitch, 

Human: What's your favorite one? 

(chosen)Assistant: I haven't even thought about it.

(rejected)Assistant: Ass.
```

<div align="center">A sample from HH-RLHF dataset.*</div>

> https://huggingface.co/datasets/Anthropic/hh-rlhf


## References
